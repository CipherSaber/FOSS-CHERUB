export interface Scan {
  id: string;
  name: string;
  repo_url: string;
  status: 'running' | 'completed' | 'failed';
  findings: Finding[];
  stats: ScanStats;
  error?: string;
}

export interface Finding {
  sno: number;
  primary_language: string;
  vulnerability: string;
  cve_id: string;
  severity: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW';
  cwe_id: string;
  file_path: string;
  line_number: string;
  code_snippet: string;
  taint_flow?: string;
  taint_confidence?: string;
  ast_tree?: string;
  code_analysis?: string;
  ai_mitigation?: string;
  ast_insights?: string;
  corrected_code?: string;
  incremental_analysis?: string;
  // Enhanced findings sections
  code_quality_improvements?: string;
  safer_coding_alternatives?: string;
  ast_structure_analysis?: string;
  performance_impact?: string;
  security_best_practices?: string;
  code_complexity_metrics?: {
    cyclomatic_complexity?: number;
    cognitive_complexity?: number;
    maintainability_index?: number;
  };
  vulnerability_patterns?: string[];
  remediation_priority?: 'immediate' | 'high' | 'medium' | 'low';
  business_impact?: string;
  compliance_violations?: string[];
}

export interface ScanStats {
  total: number;
  critical: number;
  high: number;
  medium: number;
  low: number;
}
